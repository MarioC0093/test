<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Máster de Bioestadística - Probabilidad y Simulación</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../tema_03/tema_03.html" rel="next">
<link href="../tema_02/tema_02_3_curvas_roc.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../css/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tema_02/tema_02.html">TEMA 2</a></li><li class="breadcrumb-item"><a href="../tema_02/tema_02_4_tamanyos_muestrales.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">4. Determinación de tamaños muestrales</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../DUDAS.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Dudas</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_00/tema_00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 0</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_00/tema_00_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducción</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_01/tema_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Introducción <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_2_concordancia_categoricas.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Análisis de concordancia en variables categóricas <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_3_concordancia_numericas.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Análisis de concordancia en variables numéricas <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_4_tamanyo_muestral.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Cálculo del tamaño muestral <span style="color:green;">✓</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_02/tema_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Conceptos básicos <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_2_comparacion_test_y_tamanyos_muestrales_I.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Comparación de test y tratamiento del tamaño muestral (I) <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_2_comparacion_test_y_tamanyos_muestrales_II.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Comparación de test y tratamiento del tamaño muestral (II) <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_3_curvas_roc.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Validación de biomarcadores. Curvas ROC <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_4_tamanyos_muestrales.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">4. Determinación de tamaños muestrales</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_03/tema_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Introducción <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_2_selección_aleatoria.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Selección aleatoria de pacientes y asignación de tratamientos <span style="color:red;">✗</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_3_obtener_datos_simulados.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Obtener datos simulados a partir de observaciones reales <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_4_remuestreo_inferencia_roc.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Técnicas de remuestreo aplicadas a la inferencia de curvas ROC <span style="color:red;">✗</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">In this page</h2>
   
  <ul>
  <li><a href="#determinación-de-tamaños-muestrales" id="toc-determinación-de-tamaños-muestrales" class="nav-link active" data-scroll-target="#determinación-de-tamaños-muestrales">4. Determinación de tamaños muestrales</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">4. Determinación de tamaños muestrales</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>diapo87</p>
<p>threshold es un valor de tasa a partir del cual tenemos una Se y Sp.</p>
<p>un IC suponiendo que tenemos una cantidad suficiente de datos como para asignar métodos asintóticos. En casos de enfermos y sanos no siempre tenemos esta situación.</p>
<p>la salida da tanto el AUC como su IC. y para ese pto de corte la sensi, etc. todas las propiedades de una pd.</p>
<p>ese pto de youden nos dice que tal pero, ¿cómo de buena o mala es esta prueba?</p>
<p>en el 68.% de los individuos de esa prueba, tendrían el valor positivo de la prueba. en otros estudios se podrian tener estimaciones e esa proporcion que varían entre un 58.5 % y un 77.8 %. y añadiriamos palabrería de si es válido o no</p>
<p>la sensi y la especi solo sirven cuando sabemos los resultados reales. pero lo interesante para la persona que tiene que hacer el diagnóstico es cuando nos sabemos el valor real de enfermo o sano, es decir, los valores predictivos.</p>
<p>diapo91</p>
<p>el comportamiento de esa pd en H y M no tienen una distribución similar. si bscamos a ojo un punto de discriminacion en ambas graficas, en mujeres parece que podríamos encontrar algo pero en hombres no.</p>
<p>sin distinguir individuos nosotros asignamos un resutlado positivo cuando el valor de la prueba (tasa de algo) era igual o superior a 37. empezamos un anaisis por separado.</p>
<p>comenzamos mirando la estimacion de la curva roc. una es una estimacion hecha con 37 individuos y otra hecha con 81, existe diferencia entre los tamños delas muestas.</p>
<p>si cogiese una muestra de dos valores en las mujeres (sin saber cual de cual) y digo que el mas alto es la anferma acertaría en un 81.82 % de las veces &lt;- este es el comportamiendo de la muestra puntual, la cual siempre pero aun más en una estimacion con tan poca muestra, en ineficiente.</p>
<p>todas las conclusiones cogidas con pinza y sería necesario una muestra más alta. lo que nos lleva a pensar el tamaño muestral apropiado.</p>
<p>a parte de estimar deberíamos calcular el tamaño n necesario y valorar si estamos muy lejos o no de ese tamaño.</p>
<p>la sensi muejres no puede descartar que asociando al azar entre enfermas o sanas diera un resultado distinto, ya que el 0.5 está dentro del IC.</p>
<p>en especi en mujeres ha mejorado, ya que la estimacion puntual es más alta.</p>
<p>en hombres el pto de corte es similar al anterior (lo cual tiene logica ya que la muestra conjunta era casi todo hombres)</p>
<p>la sensi es similar en mujeres, hombre y conjutna. el auc es mas baja que en la conjunta puntual,ente. aunque el ic no es tan amplia como en mueres tb es amplio. aparentemente hay mucha variabilidad intrinseca en los hombres pq el tamaño muestral es mayor pero la amplitud es similar</p>
<p>el objetivo no es trabajar con estas 141 personas. sino con la infor de estas 141 poder aplicar lsa conclusiones a otras personas o estudios, por lo que las conclusiones deben de estar fuertemente respaldadas.</p>
<p>si cambiamos el método: la curva roc obviamente es la misma, solo cambia el pto de corte optimo seleccionado.</p>
<p>los ic tocan al 0.5, algo mas que el azar hay en esta prueba (literal que esa ha sido su explicacion)</p>
<p>de la sensi dudabamos antes de tener una sensi que se alacnzase por zar. las dos prob de clasificacion podriamos admiitir que tanto una como la otra conseguimos esos resultados si hicieramos la clasificacion al azar.</p>
<p>elegir entre los dos puntos de corte: elegir un método u otro es antes de tomar resultados. no tomar uno u otro al azar en funcion de los resuktados</p>
<p>uno quiere que la se y sp sean iguales y grandes</p>
<section id="determinación-de-tamaños-muestrales" class="level2">
<h2 class="anchored" data-anchor-id="determinación-de-tamaños-muestrales">4. Determinación de tamaños muestrales</h2>
<p>antes era fijando la anchura de un IC. tb podríamos hacerlo ahora, pero nos interesa una metodlogia que consiste en hacer un contraste de hipotesis y tener un tamaño muestra para cierta potencia dada.</p>
<p>en estudios clinicos se pone en h1 la que a uno le gustaría. así cuando rechaces h0 dices “estabas protegida y mira, te he conseguido descartar”, “tengo una significatividad suficientemente grande para rechazarte”</p>
<p>a parte de esa confianza, los h tiene una potencia: prob de rechazar H0 cuando es falsa. queremos que sea máxima.</p>
<p>Obuchowski (1998) Li and Fine (2004) revisan la metodología bajo diferentes supuestos</p>
<p>cualquier tipo de pd que no sea binaria, lo que hacemos con un pto de corte es hacerla binaria.</p>
<p>diapo95</p>
<p>tamaños muestrales pra casos y orta para controles que garanticen niveles mínimos para la sensi y especi de la pd.</p>
<p><span class="math inline">\(\hat{Se} \ge TPF_0 \quad \text{(1 - fraccion de falsos negativos)}\)</span> <span class="math inline">\(\hat{Sp} \ge 1 - FPF_0 \quad \text{(1 - fraccion de falsos positivos)}\)</span></p>
<p>valor minimo que estoy dispuesto asumir para la sensi</p>
<p>“busco unos tamaños muestrales pata que la sensi de la prueba sea eta y la especi de la prueba sea esta”</p>
<p>si la especi quiero cmoom minimo este valor, entonces 1 - Sp quiero que como mucho sea 1-ese valor. cambiamos el valor minimo por una cota máxima.</p>
<p><span class="math display">\[H1: Se &lt; TFP_0 \quad \cup \quad 1 - Sp &gt; FPF_0\]</span> <span class="math display">\[H1: Se \ge TFP_0 \quad \cap \quad 1 - Sp \le FPF_0\]</span></p>
<p>diapo95</p>
<p>Región crítica: {<span class="math inline">\(\text{RegCrít}_{\alpha} = \left\{ FPF_{U}^{\alpha^*} &lt; FPF_0, \, TPF_{L}^{\alpha^*} &gt; TPF_0 \right\}\)</span>}</p>
<p>rc cuadrada y queremos una confianza de aplha, tendríamos confianza de alpha^2. de ahí sale el alpha estrella.</p>
<p>deciamos que todos los estimadores (no se cuaes) se comportaban como una binomial. vamos a trabajar con esa idea</p>
<p>numeor de enfermos y sanos se refieren a las pruebas que vamos a hacer: <span class="math inline">\(n_D, n_{\over{D}}\)</span></p>
<p>el comportamiento de estas variables se aproxima sintoticamente a una distribucion normal</p>
<ol type="1">
<li>para conseguir casos y controles, fijados niveles minimos de se y sp tengo unos valores inciales</li>
<li>compruebo si esos valores iniciales me conducen a una potencia mayor o igual a la que quiero.</li>
</ol>
<p>una condicion sobre la potencia de un contraste donde se supone que el valor de beta es un valor fijado por nosotros.</p>
<p>mediante simulacion reproduzco marcando los valoers minimos de sensi y speci con los n_D y n_overD que he marcado antes.</p>
<p>creo dist binomial y cuento cuantas veces tengo una etimacion para esos FPF_apha</p>
<p>dos valores que son los que tomamos asumiendo que la h0 es falsa. tomo dos valores dentro de la RC: <span class="math inline">\((FPF_1, TPF_1) \rightarrow\)</span> generamos muestras de tamaños <span class="math inline">\(n_D\)</span> y <span class="math inline">\(n_{\over{D}}\)</span></p>
<p>suponemos que partimos de un valor de la sensi y la especi y ahora simulamos con ese valor.</p>
<p>simulo falsos positivos con una binomial de n=casos y prob= falso positivo</p>
<p>si estoy en RC es 1, sino 0.</p>
<p>así para un n de muestras grande</p>
<p>para estimar la potencia cuento cuántas muestras me han llevado a estimaciones dentro de la rc partiendo de una H0 falsa,</p>
<p>si esa potencia está por encima del requisito esos tamaños muestrales nos sirven.</p>
<p>si no, aumentamos los tamaños muestrales y volvemos a calcular.</p>
<p><u><strong>Ejemplo 2.11.</strong></u></p>
<p>lo que yo quiero es: tener sensi de 0.9 y especi de 0.95</p>
<p>un valor dentro de la RC. y dos valores que coforman los limites de esa RC.</p>
<p><span class="math inline">\(H0: Se &lt; 0.75 \cup 1 - Sp &gt; 0.2\)</span> <span class="math inline">\(H0: Se \ge 0.75 \cap 1 - Sp \le 0.2\)</span></p>
<p><span class="math inline">\(\hat{Se} \ge TPF_0 = 0.75 -&gt; TPF_1 = 0.9\)</span> <span class="math inline">\(\hat{Sp} \ge 1 - FPF_0 = 0.2 -&gt; FPF_1 = 0.05\)</span></p>
<p>Región crítica: {<span class="math inline">\(\text{RegCrít}_{\alpha} = \left\{ FPF_{U}^{\alpha^*} &lt; 0.2, \, TPF_{L}^{\alpha^*} &gt; 0.75 \right\}\)</span>}</p>
<p>determino asitntoticamente los valores indiales para n_D y para n_overD</p>
<p>hacemos al calculo de esa normal asintotica y esos valores, y los tamaños de las meustras son 64 y 46.</p>
<p>generamos muestras de tamañaos 64 para los enfermos y 46 para los sanos.</p>
<p>hacemos la matriz correspondiente y determinamos las expresiones de la diapo95 (donde sale el dibujito de la RC)</p>
<p>calculamos beta:´´voy sumando en cuántas de esas muestras los valores estumados de fL y fU está dentro de la RC</p>
<p>0.87 – hay que repetir e ir incrementando. al llegar a 50 casos y x controles consigue la potencia</p>
<p>70 y 50 le daban</p>
<p>muestra mas grande con misma proporcion de FP y FN.</p>
<p>el primer paso es usar la dist asintotica normal para tener tañaos de partida</p>
<p>puede haber más de una solucion, ya que matematicamente podemos ir aumentando de uno en uno tanto los sanos como los controles, pero tb (si estamos cerca de la potencia deseada, claro*) podemos aumentar de dos en dos sanos y de uno en uno enfermo: a criterio de cada uno, tb dependiendo de si es muy difícil encontrar sanos o enfermos, etc.</p>
<ul>
<li>si estamos cerca de la potencia mínima deseada seguramente valga con aumentar pocas personas. si estamos muy lejos seguramente necesitemos mucha más muestra y quedaría raro si aumentamos mucho unos y muy pocos otros.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../tema_02/tema_02_3_curvas_roc.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">3. Validación de biomarcadores. Curvas ROC <span style="color:green;">✓</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../tema_03/tema_03.html" class="pagination-link">
        <span class="nav-page-text">TEMA 3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
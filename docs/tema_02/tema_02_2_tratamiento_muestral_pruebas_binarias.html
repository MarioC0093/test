<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Máster de Bioestadística - Probabilidad y Simulación</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../tema_02/tema_02_2_tratamiento_muestral_pruebas_binarias - copia.html" rel="next">
<link href="../tema_02/tema_02_1_introduccion.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../css/styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tema_02/tema_02.html">TEMA 2</a></li><li class="breadcrumb-item"><a href="../tema_02/tema_02_2_tratamiento_muestral_pruebas_binarias.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">2.Tratamiento muestral para pruebas binarias <span style="color:red;">✗</span></span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../DUDAS.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Dudas</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_00/tema_00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 0</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_00/tema_00_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducción</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_01/tema_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Introducción <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_2_concordancia_categoricas.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Análisis de concordancia en variables categóricas <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_3_concordancia_numericas.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Análisis de concordancia en variables numéricas <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_4_tamanyo_muestral.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Cálculo del tamaño muestral <span style="color:green;">✓</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_02/tema_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Conceptos básicos <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_2_tratamiento_muestral_pruebas_binarias.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">2.Tratamiento muestral para pruebas binarias <span style="color:red;">✗</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_2_tratamiento_muestral_pruebas_binarias - copia.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.Tratamiento muestral para pruebas binarias <span style="color:red;">✗</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_2_cont.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.Tratamiento muestral para pruebas binarias <span style="color:red;">✗</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_02/tema_02_3_curvas_roc.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Validación de biomarcadores. Curvas ROC <span style="color:red;">✗</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_03/tema_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Introducción <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_2_selección_aleatoria.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Selección aleatoria de pacientes y asignación de tratamientos <span style="color:red;">✗</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_3_obtener_datos_simulados.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Obtener datos simulados a partir de observaciones reales <span style="color:green;">✓</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">In this page</h2>
   
  <ul>
<li><a href="#gui%C3%B3n" id="toc-guión" class="nav-link active" data-scroll-target="#gui%C3%B3n">Guión</a></li>
  <li><a href="#regi%C3%B3n-de-confianza-para-hatse-1-hatsp" id="toc-región-de-confianza-para-hatse-1-hatsp" class="nav-link" data-scroll-target="#regi%C3%B3n-de-confianza-para-hatse-1-hatsp">Región de confianza para (<span class="math inline">\(\hat{Se}, (1-\hat{Sp})\)</span>)</a></li>
  <li><a href="#ic-para-las-razones-de-verosimilutes" id="toc-ic-para-las-razones-de-verosimilutes" class="nav-link" data-scroll-target="#ic-para-las-razones-de-verosimilutes">IC para las razones de verosimilutes</a></li>
  <li><a href="#estudios-caso-control" id="toc-estudios-caso-control" class="nav-link" data-scroll-target="#estudios-caso-control">Estudios caso control</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span class="chapter-title">2.Tratamiento muestral para pruebas binarias <span style="color:red;">✗</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>plantemoas modelos teoricos vemos métricas para comparar suponemos que estamos en modelo idondeo donde todo es perfecto pero tengo que hacer una estiamcion puntual no es nada, me toca validar resultados para comparar pruebas dicotómicas</p>
<p>diapo15</p>
<section id="guión" class="level2"><h2 class="anchored" data-anchor-id="guión">Guión</h2>
<ul>
<li>Estimaciones puntuales, por intervalo.</li>
<li>Regiones de confianza.</li>
</ul>
<ol type="a">
<li>Cohortes</li>
<li>Caso-control</li>
</ol>
<ul>
<li>Comparación entre pruebas diagnósticas</li>
<li>Métricas para comparar.</li>
<li>Criterio de periferia o preferencia (no sé lo que pone) basados en las métricas. Alternativas si el criterio no produce una conclusión.</li>
<li>Estimación de las métricas</li>
<li>Validación</li>
</ul>
<p>cada pd tiene por detrás cómo he escogido a esa muestra</p>
<p>detrás de las probabilidades hay una distribucion binomial</p>
<p>Cuando n es grande =&gt; IC asintótico</p>
<p>cenrado en p^ (lo que hemos observado) =</p>
<p><span class="math display">\[
\frac{x}{m} +- z_{\alpha/2} \frac{1}{m}\sqrt{x(1-\frac{x}{n}))}
\]</span></p>
<p>senisnbiliad: n éxitos positivos en grupo de enfermos</p>
<ol type="1">
<li>para estimar la prob de falsos positivos — (1-Sp) se usa la v.a.</li>
</ol>
<p><span class="math display">\[
X \sim \text{número de enfermos en el grupo de sanos"} \sim Bin(n_{\overline{D}}, (1-Sp))
\]</span></p>
<p><span class="math display">\[
x = n_{\overline{D}}^+
\]</span></p>
<ol start="2" type="1">
<li>Para estimar p = ppv =&gt; X = número de individuos enferos en los que tienen test postitivo</li>
</ol>
<p><span class="math display">\[
X \sim Bin(n^+, ppv), \quad \quad x =  n_{\overline{D}}^+
\]</span></p>
<ol start="3" type="1">
<li>Para estimar p = NPV =&gt; X = número de individuos enferos en los que tienen test postitivo</li>
</ol>
<p><span class="math display">\[
X \sim Bin(n^-, npv), \quad \quad x =  n_{\overline{D}}^-
\]</span></p>
<p>la cuestion es identificar qué estamos investigando en cada uno de los casos, saber cuál es mi éxito y dentro de qué subgrupo estamos mirando el número de éxitos</p>
<p>la sensi y la especi son dos cantidades. si estimo un ic para esas cosas, estoy cometiendo un error. si estoy estimando dos cosas, el error total que tengo es mayor o la precision total es menor.</p>
<p>los estimadores de la probabildiades de clasificacion son independientes. que la sensi sea grande no influye con que la especi sea grande o pequeña.</p>
<p>prob de IC 0.9, prob de que la sensi esté dentro de un intervalo, 0.9. prob de que la sensi esté dentro de mi intervalo y la especi dentro de mi intervalo, 0.9*0.9</p>
<p>ya que son indep ambas estimaciones vamos a buscar una region de confianza de tal forma que ambas estimaciones estén dentro de esa región con una prob del 0.9.</p>
</section><section id="región-de-confianza-para-hatse-1-hatsp" class="level2"><h2 class="anchored" data-anchor-id="región-de-confianza-para-hatse-1-hatsp">Región de confianza para (<span class="math inline">\(\hat{Se}, (1-\hat{Sp})\)</span>)</h2>
<p>ic de la sensi multiplacado por el ic de 1-sp (es un “multiplicado” teórico para entenderlo)</p>
<p>confianza bidiensional sea 1-alpha</p>
<p>1-apha = prob caer en el IC * prob de caer en el otro IC = beta^2 tq beta=sqrt(1-alpha)</p>
<p>la RC es una zona de confort en dos dimensioesn. si trabajo en con las dos dimensiones separadas consigo una confianza menor a la que yo tenía</p>
<p>diapo18 <strong><span class="math inline">\(\hat(ppv)\)</span></strong></p>
<p>estimos los casos positivos: 930 cuántos lo son de verdad: 815</p>
<p>hat(npv) = 327/535</p>
<p>en medcal por defecto te calcula la asitótica, aunque tengas una muestra de 3 esto tira por la asintótica siempre.</p>
<p>Estimamos las razones de verosimilitud con las estimacions de las probabilidades de clasificaciones</p>
<p><span class="math inline">\(\hat{DLR^+} = \frac{\hat{Se}}{\hat{1-Sp}}\)</span></p>
<p><span class="math inline">\(\hat{DLR^-} = \frac{\hat{1-Se}}{\hat{Sp}}\)</span></p>
<p>comparacion de casso positivos que tengo dentro del grupo de enfermos y sanos- en funcion del cociente decíamos que era más verosimil</p>
<p>DLR+^: un resultado positivo es 30 veces más creíble en el grupo de enfermos que en el grupo de sanos DLR+^: comparamos negativos en grupo de sanos y enfermos, gripo de enferms en sanos deben ser pocos, por que lo que DLR-^&lt;&lt;&lt;1, para facilitar la comparativa se le suele dar la vuelta (porque debe ser más fácil interpretar un 2 que un 0.5)</p>
</section><section id="ic-para-las-razones-de-verosimilutes" class="level2"><h2 class="anchored" data-anchor-id="ic-para-las-razones-de-verosimilutes">IC para las razones de verosimilutes</h2>
<p>hay que ponerse en aquellos casos donde es más facil tener exito, supongamos n grande.</p>
<p>pasamos a escala logarítmica, así separo la componente de la sensi y la componente de la especi. trabajamos con el método delta de la diapo 19.</p>
<p>que dice: las dos razones de vero no son independientes sino que su comportamiento cuando trabajamos con sus logaritmos tienen un comportamiento normal bidimensional. la cobaranza dice: cuando una razon aunmenta la otra disminuye (mirar la matriz de varianzas y covarianzas)</p>
<p>una normal bidimensional. de esa nbidimi puedo crear una RConfianza.</p>
<p>la RC es para los logaritmos de las razones.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Definimos la media y la matriz de covarianza</span></span>
<span><span class="va">media</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">covarianza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generamos los puntos con una distribución normal multivariada</span></span>
<span><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mu <span class="op">=</span> <span class="va">media</span>, Sigma <span class="op">=</span> <span class="va">covarianza</span><span class="op">)</span></span>
<span><span class="va">datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">datos</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">plot3D</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu">mclust</span><span class="fu">::</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/dmvnorm.html">dmvnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, mean <span class="op">=</span> <span class="va">media</span>, sigma <span class="op">=</span> <span class="va">covarianza</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plot3D/man/persp3D.html">persp3D</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span>, theta <span class="op">=</span> <span class="fl">30</span>, phi <span class="op">=</span> <span class="fl">20</span>, expand <span class="op">=</span> <span class="fl">0.6</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, main <span class="op">=</span> <span class="st">"Distribución Gaussiana Bidimensional"</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tema_02_2_tratamiento_muestral_pruebas_binarias_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>ejemplo.</p>
<p>dado IC del log(hat(DLR+)) = (-0.6,2) cuál es el IC(hat(DLR+)) = (e^-0.6, e^2) = 0.55, 0.79 e^-0.6 &lt; hat(DLR+) &lt; e^2</p>
<p>el test de esfuerzo da positivo tres veces más en los enfermos que en sanos. es tres veces masversosimili encontrar un positivo en la prueba de esfuerzo en un individuo enfermo que en un individio sano</p>
<p>cuando tenemos un resultado negativo en esa prueba es casi cuatro veces 3.7 mas verosimil un negativo sobre un individuo sano que sobre un individuo enfermo.</p>
<p>queriamo pd que tuvieran razones grands grandes en casso de los positivos y peques peques en el caso de los negativos.</p>
<p>pasamos los IC de la escala logartimica a la escala que nos interesa.</p>
</section><section id="estudios-caso-control" class="level2"><h2 class="anchored" data-anchor-id="estudios-caso-control">Estudios caso control</h2>
<p>un grupo sabemos que tiene la enfermedad y otra sabemos que no la tiene</p>
<p>teniendo una idea de que las ramas de estos estudios estan equilirbados tendremos una canitdad en los casos y una cantidad en los controles que suelen estar equilirbados. lo bueno es que tenemos una situacion equilibrada, lo malo es que no es una situacion representativa.</p>
<p>la prevalencia que tenemos en al muestra es muchisimo mayor que en la poblacion. no afecta a la estimacion de sensi, de especi ni las razones. lo que no nos vale son los valores predictivos.</p>
<p>supongamos que tengo una etimacion para la prevalencia real.</p>
<p>en caso control la prevalencia de la poblacion no se conserrva en la muestra, cuando es cohortes ese problema no se tiene. porque he bsuacado un grupo de individuos que se han sometido a un riesgo y he esperado a ver si tenían o no la enfermedad, no he elegido.</p>
<p>trabajo con canitdad no que dependan del tamaño de la muestra, sino de la prevalencia. uso el tma bayes para expresar los valores predictivos en funcion de la sensi y la especi, ed, en las proabildiades de clasficiacion.</p>
<p>ppv = p(D=1 | Y=1) = —formula del otro día =&gt; ppv = num: Se * prev den: se.prev + (1-sp)(1-prev)</p>
<p>npv (sin gorro) = Sp(1-prev) / Sp(1-prev) + (1-se)prev</p>
<p>supongams que no sabemos el valor exacto de la prev.</p>
<p>si la prev es máxima, uno: ppv=1. si la prev es mínimo, cero: ppv=0.</p>
<p>sacar graficquito (para algún ejercicio o ejemplo) cómo aumenta el ppv para cierto se y sp en función de cómo aumenta la pervalencia de cero a uno</p>
<p>si la prev es máxima, uno: npv=0. si la prev es mínimo, cero: npv=1.</p>
<p>la estimacion del valor</p>
<p>“o la estimacion ha cambiado y ha crecido, cómo afecta”, el ppc crece al aumentar la prevalencia y el npv decrece al aumentar la rpevalencia</p>
<p>relacion entre el logaritmo de la fversolimilitu con el logartimo de esa x que no sé lo que es.</p>
<p><span class="math inline">\(\frac{PPV}{1-PPV} = DLR^+ (\frac{\rho}{1-\rho})\)</span></p>
<p><span class="math inline">\(ln(\frac{PPV}{1-PPV}9 = ln(DLR^) + ln(\frac{\rho}{1-\rho})\)</span></p>
<p>Si el IC_ln(DLR+) = (a,b). Al logit de rho le llamo H. H = <span class="math inline">\(ln(\frac{\rho}{1-\rho})\)</span></p>
<p><span class="math display">\[\exp^{a+H} &lt; \frac{\hat{ppv}}{1-\hat{ppv}} \Rightarrow \exp^{a+H} - \exp^{a+H} \hat{ppv} &lt;  \hat{ppv}\]</span></p>
<p><span class="math display">\[\frac{\hat{ppv}}{1-\hat{ppv}} &lt; \exp^{b+H} \Rightarrow \hat{ppv} &lt; \exp^{a+H} - \exp^{a+H} \hat{ppv} &lt; \]</span></p>
<p><span class="math display">\[\frac{\exp^{a+h}}{1+\exp^{a+h}} &lt; \hat{ppv} &lt; \frac{\exp^{b+h}}{1+\exp^{b+h}}\]</span></p>
<p>diapo23</p>
<p>logit(rho) = H</p>
<p>logit(npv) = -H - ln(DLR-)</p>
<p>Supongamo que IC_ln(hat(DLR-)) = (A, B) (luego le pongo yo otra letras para no confundirlo con a y b) =&gt;</p>
<p>A &lt; ln(hat(DLR-)) &lt; B</p>
<p>-B &lt; -ln(hat(DLR-)) &lt; -A</p>
<ul>
<li><p>H - B &lt; logit(npv) &lt; - H - A</p></li>
<li><p>(H-B) &lt; NPV / (1-NPV) &lt; - (H+A)</p></li>
<li><p>(H-B) &lt; ln(NPV / (1-NPV)) &lt; - (H+A)</p></li>
</ul>
<p>e^(- (H-B)) &lt; NPV / (1-NPV) &lt; e^(- (H+A))</p>
<p>e^(- (H-B)) * (1-NPV) &lt; NPV &lt; e^(- (H+A)) * (1-NPV)</p>
<p>e^(- (H-B)) / (1 e^(- (H-B))) &lt; NPV &lt; e^(- (H-A)) / (1 e^(- (H-A)))</p>
<p>diapo24. el ic me dice que estima mal la rpeuab diagnóstica. si dando positivo solo acierto al enfermedad de 0.08 a 0.2 (oooo algo así)</p>
<p>el ic 008 a 0.2 no es muy grande pq lo máximo .</p>
<p>tienes un valor positivo en la prueba, dando un diagnóstico positivo, cómo de bien lo haces. la pd no es buena pq solo acertaría entre un 0.08 y un 0.2 basándome en haber visto un valor positivo en la prueba.</p>
<p>si uno toma esta pd para hacer un diagnóstico en funcion del resultado los aciertos son muy pocos.</p>
<p>diapo25.</p>
<p>cada mediada está enfocada a cosas distintas. la probabildiad de prediccion: cómo refleja la prueba el estado real del paciente.</p>
<p>los valores precitivos es al reves, los valroes clinicos de la prueba.</p>
<p>lo tercero como de creible es un valor postivio o negativo.</p>
<p>puedeo elegir cualquiera para comparar dos pd.</p>
<p>los cocienes son fáciles, los odd ratio son odiosos.</p>
<p>si tengo dos pd basadas en unidades distintas, no puedo hacer restas. pero si tengo cocientes sí puedo hacer comparaciones.</p>
<p>si no preferencia basada en prob de clasificacion hayla en la basada en la ppv</p>
<p>si fallo en la i) voy a la iii) a ver qué pasa</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../tema_02/tema_02_1_introduccion.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">1. Conceptos básicos <span style="color:green;">✓</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../tema_02/tema_02_2_tratamiento_muestral_pruebas_binarias - copia.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">2.Tratamiento muestral para pruebas binarias <span style="color:red;">✗</span></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
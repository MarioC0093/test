<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Máster de Bioestadística - Probabilidad y Simulación</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../tema_01/tema_01_3_concordancia_numericas.html" rel="next">
<link href="../tema_01/tema_01_1_introduccion.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../css/styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tema_01/tema_01.html">TEMA 1</a></li><li class="breadcrumb-item"><a href="../tema_01/tema_01_2_concordancia_categoricas.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">2. Análisis de concordancia en variables categóricas <span style="color:green;">✓</span></span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../DUDAS.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Dudas</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_00/tema_00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 0</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_00/tema_00_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducción</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_01/tema_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Introducción <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_2_concordancia_categoricas.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">2. Análisis de concordancia en variables categóricas <span style="color:green;">✓</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_3_concordancia_numericas.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Análisis de concordancia en variables numéricas <span style="color:red;">✗</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_01/tema_01_4_tamanyo_muestral.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Cálculo del tamaño muestral</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tema_03/tema_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TEMA 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_1_introduccion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Introducción</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_2_selección_aleatoria.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Selección aleatoria de pacientes y asignación de tratamientos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tema_03/tema_03_3_obtener_datos_simulados.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Obtener datos simulados a partir de observaciones reales</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">In this page</h2>
   
  <ul>
<li><a href="#clasificaciones-binomiales" id="toc-clasificaciones-binomiales" class="nav-link active" data-scroll-target="#clasificaciones-binomiales">Clasificaciones binomiales</a></li>
  <li><a href="#acuerdo-observado-o-%C3%ADndice-de-concordancia-global" id="toc-acuerdo-observado-o-índice-de-concordancia-global" class="nav-link" data-scroll-target="#acuerdo-observado-o-%C3%ADndice-de-concordancia-global">Acuerdo observado o Índice de concordancia global</a></li>
  <li><a href="#%C3%ADndice-kappa-de-cohen" id="toc-índice-kappa-de-cohen" class="nav-link" data-scroll-target="#%C3%ADndice-kappa-de-cohen">Índice kappa (de Cohen)</a></li>
  <li><a href="#interpretaci%C3%B3n-del-%C3%ADndice-kappa-si-k0" id="toc-interpretación-del-índice-kappa-si-k0" class="nav-link" data-scroll-target="#interpretaci%C3%B3n-del-%C3%ADndice-kappa-si-k0">Interpretación del índice kappa (si <span class="math inline">\(k\)</span>&gt;0)</a></li>
  <li>
<a href="#clasificaciones-multinomiales" id="toc-clasificaciones-multinomiales" class="nav-link" data-scroll-target="#clasificaciones-multinomiales">Clasificaciones multinomiales</a>
  <ul>
<li><a href="#medida-de-concordancia-global" id="toc-medida-de-concordancia-global" class="nav-link" data-scroll-target="#medida-de-concordancia-global">Medida de concordancia global</a></li>
  <li><a href="#medida-de-concordancia-debida-al-azar" id="toc-medida-de-concordancia-debida-al-azar" class="nav-link" data-scroll-target="#medida-de-concordancia-debida-al-azar">Medida de concordancia debida al azar</a></li>
  <li><a href="#%C3%ADndice-kappa" id="toc-índice-kappa" class="nav-link" data-scroll-target="#%C3%ADndice-kappa">Índice kappa</a></li>
  <li><a href="#comparando-cada-categor%C3%ADa-con-el-resto" id="toc-comparando-cada-categoría-con-el-resto" class="nav-link" data-scroll-target="#comparando-cada-categor%C3%ADa-con-el-resto">Comparando cada categoría con el resto</a></li>
  </ul>
</li>
  <li>
<a href="#inconvenientes-del-%C3%ADndice-kappa" id="toc-inconvenientes-del-índice-kappa" class="nav-link" data-scroll-target="#inconvenientes-del-%C3%ADndice-kappa">Inconvenientes del índice kappa</a>
  <ul>
<li><a href="#el-valor-del-%C3%ADndice-kappa-depende-de-la-prevalencia-de-la-caracter%C3%ADstica-observada." id="toc-el-valor-del-índice-kappa-depende-de-la-prevalencia-de-la-característica-observada." class="nav-link" data-scroll-target="#el-valor-del-%C3%ADndice-kappa-depende-de-la-prevalencia-de-la-caracter%C3%ADstica-observada.">El valor del índice kappa depende de la prevalencia de la característica observada.</a></li>
  <li><a href="#el-valor-del-%C3%ADndice-kappa-depende-de-la-simetr%C3%ADa-y-homogeneidad-de-las-marginales." id="toc-el-valor-del-índice-kappa-depende-de-la-simetría-y-homogeneidad-de-las-marginales." class="nav-link" data-scroll-target="#el-valor-del-%C3%ADndice-kappa-depende-de-la-simetr%C3%ADa-y-homogeneidad-de-las-marginales.">El valor del índice kappa depende de la simetría y homogeneidad de las marginales.</a></li>
  <li><a href="#el-valor-del-%C3%ADndice-kappa-depende-del-equilibrio-de-las-marginales." id="toc-el-valor-del-índice-kappa-depende-del-equilibrio-de-las-marginales." class="nav-link" data-scroll-target="#el-valor-del-%C3%ADndice-kappa-depende-del-equilibrio-de-las-marginales.">El valor del índice kappa depende del equilibrio de las marginales.</a></li>
  </ul>
</li>
  <li>
<a href="#%C3%ADndice-kappa-ponderado." id="toc-índice-kappa-ponderado." class="nav-link" data-scroll-target="#%C3%ADndice-kappa-ponderado.">Índice kappa ponderado.</a>
  <ul>
<li><a href="#ponderaciones." id="toc-ponderaciones." class="nav-link" data-scroll-target="#ponderaciones.">Ponderaciones.</a></li>
  </ul>
</li>
  <li>
<a href="#tratamiento-muestral-de-los-%C3%ADndices-kappa" id="toc-tratamiento-muestral-de-los-índices-kappa" class="nav-link" data-scroll-target="#tratamiento-muestral-de-los-%C3%ADndices-kappa">Tratamiento muestral de los índices kappa</a>
  <ul>
<li><a href="#ejemplo-1.4." id="toc-ejemplo-1.4." class="nav-link" data-scroll-target="#ejemplo-1.4.">Ejemplo 1.4.</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span class="chapter-title">2. Análisis de concordancia en variables categóricas <span style="color:green;">✓</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="clasificaciones-binomiales" class="level2"><h2 class="anchored" data-anchor-id="clasificaciones-binomiales">Clasificaciones binomiales</h2>
<p>Casos donde la prueba diagnóstica solo presenta dos resultados distintos.</p>
<p>Analizamos si dos agentes que clasifican a los individuos según el resultado de la p.d. concuerdan en sus opiniones. También me sirve la discordancia completa. (sé que un agente siempre clasifica lo contrario al otro agente)</p>
<p>Como la p.d. depende del agente que me da la medida, tengo una variable aleatoria por cada agente.</p>
<p>X = “clasificación dada por el observador A.”<br>
Y = “clasificación dada por el observador B.”</p>
<p>Dado un individuo va a ser analizado por el agente A y el agente B y cada uno de ellos va a dar su opinión.</p>
<p><span class="math display">\[
\displaylines{
&amp; \text {Medidas para cada inidividuo} \\
&amp;\begin{array}{ccc}
\hline
\text{individuo k} &amp; X_k &amp; Y_k
\end{array}
}
\]</span></p>
<p><u>Resumen de la información del modelo teórico.</u></p>
<p>Suponemos distribución de probabilidad conjunta.</p>
<p><span class="math display">\[
\begin{array}{c|c c c c}
    &amp; &amp; \textbf{Y} &amp; &amp; \\
    &amp; \textbf{Categoría} &amp; \textbf{1} &amp; \textbf{2} &amp; \textbf{Total} \\
\hline
\textbf{X} &amp; \textbf{1} &amp; \pi_{11} &amp; \pi_{12} &amp; \pi_{1\cdot} \\
           &amp; \textbf{2} &amp; \pi_{21} &amp; \pi_{22} &amp; \pi_{2\cdot} \\
\hline
&amp; \textbf{Total} &amp; \pi_{\cdot1} &amp; \pi_{\cdot2} &amp; 1 \\
\end{array}
\]</span></p>
<p><span class="math display">\[
\begin{array}{}
&amp;\pi_{.j} = (X,Y) \epsilon {(1,1),(1,2),(2,1),(2,2)} \\
\pi_{ij} = \text{p({X=i, Y=j})} &amp; \pi_{i.} = \text{p({Y=j})} &amp; \pi_{.j} =  \text{p({X=i})} \\
\end{array}
\]</span></p>
</section><section id="acuerdo-observado-o-índice-de-concordancia-global" class="level2"><h2 class="anchored" data-anchor-id="acuerdo-observado-o-índice-de-concordancia-global">Acuerdo observado o Índice de concordancia global</h2>
<p>La aproximación a la concordancia más intuitiva. Expresa el porcentaje de coincidencia en la clasificación de ambos agentes.</p>
<p>El problema que plantea este índice básico es que una parte de ese acuerdo puede deberse exclusivamente al azar.</p>
<p>Medir la concordancia es saber la probabilidad con la que los dos dan la misma clasificación.</p>
<div class="recuadro_2">
<p><strong>Medida de concordancia global</strong>: <span class="math inline">\(\Pi_0 = \pi_{11} + \pi_{22} = \sum_{i=j} \pi_{ij}\)</span></p>
</div>
<p><u><strong>Ejemplo 1.0.</strong></u></p>
<p>Se recogen las respuestas a las entrevistas 1 y 2 de manera independiente.<br>
Entrevista 1: ¿Consume usted suplementos vitamínicos?<br>
Entrevista 2: Responda si consume vitaminas sin contar sus aportes alimentarios</p>
<ul>
<li>
<u><strong>Caso 1. Concordancia perfecta.</strong></u> {X=Y} o {X<span class="math inline">\(\neq\)</span>Y}<br>
p({X=Y})=1</li>
</ul>
<p><span class="math display">\[
\begin{array}{c|c c c c}
&amp; &amp; \textbf{Entervista 1} \\
&amp; &amp; \textbf{No} &amp; \textbf{Sí} &amp; \textbf{Total} \\
\hline
\textbf{Entrevista 2} &amp; \textbf{No} &amp; 0.6 &amp; 0 &amp; 0.6 \\
                      &amp; \textbf{Sí} &amp; 0 &amp; 0.4 &amp; 0.4 \\
\hline
&amp; \textbf{Total} &amp; 0.6 &amp; 0.4 &amp; 1 \\
\end{array}
\]</span></p>
<div style="padding-left: 34px;">
<p>La probabilidad de que un individuo conteste lo mismo en ambos cuestionarios es 1.</p>
</div>
<ul>
<li><u><strong>Caso 2. Concordancia.</strong></u></li>
</ul>
<p><span class="math display">\[
\begin{array}{c|c c c c}
&amp; &amp; \textbf{Entervista 1} \\
&amp; &amp; \textbf{No} &amp; \textbf{2} &amp; \textbf{Sí} \\
\hline
\textbf{Entrevista 2} &amp; \textbf{No} &amp; 0.4 &amp; 0.2 &amp; 0.6 \\
                      &amp; \textbf{Sí} &amp; 0.2 &amp; 0.2 &amp; 0.4 \\
\hline
&amp; \textbf{Total} &amp; 0.6 &amp; 0.4 &amp; 1 \\
\end{array}
\]</span></p>
<div style="padding-left: 34px;">
<p>La probabilidad de dar la misma respuesta es 0.8.</p>
</div>
<ul>
<li><u><strong>Caso 3. Sin concordancia.</strong></u></li>
</ul>
<div style="padding-left: 34px;">
<p>Las dos entrevistas concuerdan el 40 % de las ocasiones. Puede no haber asociación real entre las dos entrevistas porque toda la concordancia puede atribuirse al azar.</p>
<p>¿Cuál sería la distribución de las respuestas si los individuos responden tirando una moneda? (cara: no, cruz: sí)</p>
<p>p(X=“no”, Y=“sí”) = p(“sale cara primera moneda”, “sale cara segunda moneda”) = 0.5 * 0.5 = 0.25<br>
p(X=“sí”, Y=“no”) = p(X=“no”, Y=“no”) = p(X=“sí”, Y=“sí”) = 0.25</p>
<p><span class="math inline">\(\pi_{0}\)</span> = 0.25 + 0.25 = 0.5<br><span class="math inline">\(\pi_{i} = \pi_{1.} * \pi_{.1} + \pi_{2.} * \pi_{.2}\)</span> = 0.5 * 0.5 + 0.5 * 0.5 (concordancia debida al azar)</p>
</div>
<p><span class="math display">\[
\begin{array}{c|c c c c}
&amp; &amp; \textbf{Entervista 1} \\
&amp; &amp; \textbf{No} &amp; \textbf{Sí} &amp; \textbf{Total} \\
\hline
\textbf{Entrevista 2} &amp; \textbf{No} &amp; 0.25 &amp; 0.25 &amp; 0.5 \\
                      &amp; \textbf{Sí} &amp; 0.25 &amp; 0.25 &amp; 0.5 \\
\hline
&amp; \textbf{Total} &amp; 0.5 &amp; 0.5 &amp; 1 \\
\end{array}
\]</span></p>
<div style="padding-left: 34px;">
<p>Esta sería la máxima no concordancia, ya que si la diagonal principal acumula menos de la mitad de los casos podríamos medir una concordancia inversa.</p>
</div>
<p><span class="math display">\[
\begin{array}{c|c c c c}
&amp; &amp; \textbf{Entervista 1} \\
&amp; &amp; \textbf{No} &amp; \textbf{Sí} &amp; \textbf{Total} \\
\hline
\textbf{Entrevista 2} &amp; \textbf{No} &amp; 0.3 &amp; 0.3 &amp; 0.6 \\
                      &amp; \textbf{Sí} &amp; 0.3 &amp; 0.1 &amp; 0.4 \\
\hline
&amp; \textbf{Total} &amp; 0.6 &amp; 0.4 &amp; 1 \\
\end{array}
\]</span></p>
<p><strong>El problema de <span class="math inline">\(\Pi_{0}\)</span> es que incluye concordancia que puede atribuirse al azar. Y concordar por azar no es concordar.</strong></p>
<p>Si los dos observadores clasificasen de forma independiente y, por tanto, totalmente al azar en las dos categorías, la probabilidad de la concordancia (p(X=Y)) sería:</p>
<div class="recuadro_2">
<p><strong>Medida de concordancia debida al azar</strong>: <span class="math inline">\(\Pi_c = \pi_{1.}\pi_{.1} + \pi_{2.}\pi_{.2} = \sum_{k=1,2} \pi_{k.}\pi_{.k}\)</span></p>
</div>
<p><strong>A la concordancia global debo restarle la concordancia del azar.</strong></p>
</section><section id="índice-kappa-de-cohen" class="level2"><h2 class="anchored" data-anchor-id="índice-kappa-de-cohen">Índice kappa (de Cohen)</h2>
<p>Este índice es una medida basada en resultados teóricos.</p>
<p><span class="math inline">\(k = \frac{\Pi_0-\Pi_c}{1-\Pi_c}\)</span> tq <span class="math inline">\(\Pi_0 = \pi_{11} + \pi_{22}\)</span> y <span class="math inline">\(\Pi_c = \pi_{1.}\pi_{.1} + \pi_{2.}\pi_{.2}\)</span></p>
<p>A la concordancia le quita la concordancia debida al azar y lo compara con la concordancia perfecto sin contar la concordancia al azar. Es decir, a la concordancia y a la concordancia perfecta les substrae la concordancia debida al azar y compara la concordancia sin el azar obtenida contra la máxima concordancia sin el azar posible.</p>
<p>La interpretabilidad o Podemos tener resultados negativos: el intervalor [-1,0) es sin corcondancia.</p>
<p><u><strong>Ejemplo 1.0.</strong></u></p>
<ul>
<li><u><strong>Caso 1. Concordancia perfecta.</strong></u></li>
</ul>
<p><span class="math display">\[
\begin{array}{c|c c c c}
&amp; &amp; \textbf{Entervista 1} \\
&amp; &amp; \textbf{No} &amp; \textbf{Sí} &amp; \textbf{Total} \\
\hline
\textbf{Entrevista 2} &amp; \textbf{No} &amp; 0.6 &amp; 0 &amp; 0.6 \\
                      &amp; \textbf{Sí} &amp; 0 &amp; 0.4 &amp; 0.4 \\
\hline
&amp; \textbf{Total} &amp; 0.6 &amp; 0.4 &amp; 1 \\
\end{array}
\]</span></p>
<div style="padding-left: 34px;">
<p>Cuando tengo una concordancia perfecta, la concordancia debido al azar es 0.5.</p>
<p><span class="math inline">\(\Pi_c = \pi_{1.}\pi_{.1} + \pi_{2.}\pi_{.2} = 0.36 + 0.24 = 0.5\)</span></p>
Y POR EEEEEEEEEEEESO, usamos el índice kappa del señor Cohen.
<div>

<ul>
<li><u><strong>Caso 3. Sin corcondancia.</strong></u></li>
</ul>
<p>Cuando la concordancia o acuerdo observado coincide con la esperada por el azar el índice kappa toma el valor 0.</p>
<p><span class="math display">\[
\begin{array}{c|c c c c}
&amp; &amp; \textbf{Entervista 1} \\
&amp; &amp; \textbf{No} &amp; \textbf{Sí} &amp; \textbf{Total} \\
\hline
\textbf{Entrevista 2} &amp; \textbf{No} &amp; 0.25 &amp; 0.25 &amp; 0.5 \\
                      &amp; \textbf{Sí} &amp; 0.25 &amp; 0.25 &amp; 0.5 \\
\hline
&amp; \textbf{Total} &amp; 0.5 &amp; 0.5 &amp; 1 \\
\end{array}
\]</span> <span class="math inline">\(\Pi_0 = \pi_{11} + \pi_{22} = 0.5\)</span> y <span class="math inline">\(\Pi_c = \pi_{1.}\pi_{.1} + \pi_{2.}\pi_{.2} = 0.5*0.5 + 0.5*0.5 = 0.5\)</span></p>
<p><span class="math inline">\(k = \frac{0.5-0.5}{1-0.5} = 0\)</span></p>
<p><span class="math display">\[
\begin{array}{c|c c c c}
&amp; &amp; \textbf{Entervista 1} \\
&amp; &amp; \textbf{No} &amp; \textbf{Sí} &amp; \textbf{Total} \\
\hline
\textbf{Entrevista 2} &amp; \textbf{No} &amp; 0.3 &amp; 0.3 &amp; 0.6 \\
                      &amp; \textbf{Sí} &amp; 0.3 &amp; 0.1 &amp; 0.4 \\
\hline
&amp; \textbf{Total} &amp; 0.6 &amp; 0.4 &amp; 1 \\
\end{array}
\]</span></p>
<p><span class="math inline">\(\Pi_0 = \pi_{11} + \pi_{22} = 0.4\)</span> y <span class="math inline">\(\Pi_c = \pi_{1.}\pi_{.1} + \pi_{2.}\pi_{.2} = 0.6*0.6 + 0.4*0.4 = 0.52\)</span></p>
<p><span class="math inline">\(k = \frac{0.4-0.52}{1-0.52} = -0.25\)</span></p>

<section id="interpretación-del-índice-kappa-si-k0" class="level2"><h2 class="anchored" data-anchor-id="interpretación-del-índice-kappa-si-k0">Interpretación del índice kappa (si <span class="math inline">\(k\)</span>&gt;0)</h2>
<p>Los datos observados son un caso particular.</p>
<p>La probabilidad de acuerdo observado es una media ponderada del máximo acuerdo (1) y del acuerdo debido al azar (<span class="math inline">\(Pi_{c\)</span>), siendo <span class="math inline">\(k\)</span> el peso del máximo acuerdo.</p>
<div class="recuadro_2">
<p><span class="math display">\[
\displaylines{
k = \frac{\Pi_0-\Pi_c}{1-\Pi_c} \\ \\
k * (1-\Pi_{i}) = (\Pi_{0} - \Pi_{c}) \\ \\
\Pi_{0} = k + (1-k)*\Pi_{c}
}
\]</span></p>
<p><strong>El acuerdo observado es una combinación de la concordania perfecta y concordania debida al azar</strong>. El ínidce kappa da más peso a uno o al otro.</p>
</div>
<p><u><strong>Ejemplo 1.1.</strong></u></p>
<p><span class="math display">\[
\begin{array}{cc|ccc}
&amp; &amp; \textbf{Radiólogo A} \\
&amp; &amp; \textbf{Pulmonía} &amp; \textbf{No pulmonía} &amp; \textbf{Total} \\
\hline
\textbf{Radiólogo B} &amp; \textbf{Pulmonía} &amp; 0.04 &amp; 0.06 &amp; 0.10 \\
                      &amp; \textbf{No pulmonía} &amp; 0.10 &amp; 0.80 &amp; 0.90 \\
\hline
&amp; \textbf{Total} &amp; 0.14 &amp; 0.86 &amp; 1 \\
\end{array}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.06</span>, <span class="fl">0.10</span>, <span class="fl">0.80</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pulmonía B"</span>, <span class="st">"No pulmonía B"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pulmonía A"</span>, <span class="st">"No pulmonía A"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Pulmonía A No pulmonía A
Pulmonía B          0.04          0.06
No pulmonía B       0.10          0.80</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.10</span><span class="op">)</span>,</span>
<span>                 col2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.06</span>, <span class="fl">0.80</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pulmonía A"</span>, <span class="st">"No pulmonía A"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pulmonía B"</span>, <span class="st">"No pulmonía B"</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Pulmonía A No pulmonía A
Pulmonía B          0.04          0.06
No pulmonía B       0.10          0.80</code></pre>
</div>
</div>
<p><span class="math inline">\(\Pi_{0} = \text{"concordancia absoluta"} = 0.04 + 0.80 = 0.84\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">df</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía B"</span>,<span class="st">"Pulmonía A"</span><span class="op">]</span> <span class="op">+</span> <span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía B"</span>,<span class="st">"No pulmonía A"</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.84</code></pre>
</div>
</div>
<p><span class="math inline">\(\Pi_{1} = \text{"concordancia debida al azar"} = 0.10*0.14 + 0.86*0.90 = 0.788\)</span></p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía B"</span>,<span class="op">]</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía B"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.788</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.788</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.788</code></pre>
</div>
</div>
<p><strong>Interpretación.</strong>]{underline}<br>
La concordancia observada en los informes (84%) está compuesta por un 24,5% de la concordancia máxima y un 78,8% de la esperada al azar.</p>
</section><section id="clasificaciones-multinomiales" class="level2"><h2 class="anchored" data-anchor-id="clasificaciones-multinomiales">Clasificaciones multinomiales</h2>
<p><span class="math display">\[
\begin{array}{c|c c c c}
    &amp; &amp; \textbf{Y} &amp; &amp; \\
    &amp; \textbf{Categoría} &amp; \textbf{1} &amp; \textbf{...} &amp; \textbf{t} &amp; \textbf{Total} \\
\hline
\textbf{X} &amp; \textbf{1} &amp; \pi_{11} &amp; ... &amp; \pi_{1t} &amp; \pi_{1\cdot} \\
           &amp; \textbf{2} &amp; \pi_{21} &amp; ... &amp; \pi_{2t} &amp; \pi_{2\cdot} \\
           &amp; \textbf{...} &amp; ... &amp; ... &amp; ... &amp; ... \\
           &amp; \textbf{t} &amp; \pi_{2t} &amp; ... &amp; \pi_{tt} &amp; \pi_{t\cdot} \\
\hline
&amp; \textbf{Total} &amp; \pi_{\cdot1} &amp; ... &amp; \pi_{\cdot t} &amp; 1 \\
\end{array}
\]</span></p>
<div class="recuadro_2">
<p><strong>Medida de concordancia global</strong>: <span class="math inline">\(\Pi_0 = \sum_{i=1}^{t} \pi_{ii}\)</span></p>
</div>
<div class="recuadro_2">
<p><strong>Medida de concordancia debida al azar</strong>: <span class="math inline">\(\Pi_c = \sum_{i=1}^{t} \pi_{i.}\pi_{.i}\)</span></p>
</div>
<div class="recuadro_2">
<p><strong>Índice kappa</strong>: <span class="math inline">\(k = \frac{\Pi_0-\Pi_c}{1-\Pi_c}\)</span></p>
</div>
<p>Hay veces que nos interesa saber si la concordancia es mayor en unas categorías o en otras. Por ejemplo, en la categoría <em>grave</em> hay muchas concordancia pero en las categorías <em>leve</em> y <em>media</em> no. En este caso se suele estandarizar para tener dos categorías y medir concordancia para cada categoría.</p>
<p><u><strong>Ejemplo 1.2.</strong></u></p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1125</span>, <span class="fl">0.1</span>, <span class="fl">0.0375</span><span class="op">)</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1125</span>, <span class="fl">0.3625</span>, <span class="fl">0.0625</span><span class="op">)</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.0375</span>, <span class="fl">0.175</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Leve"</span>, <span class="st">"Moderada"</span>, <span class="st">"Grave"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Leve"</span>, <span class="st">"Moderada"</span>, <span class="st">"Grave"</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Leve Moderada  Grave
Leve     0.1125   0.1000 0.0375
Moderada 0.1125   0.3625 0.0625
Grave    0.0000   0.0375 0.1750</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_extended</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Leve Moderada  Grave
Leve     0.1125   0.1000 0.0375
Moderada 0.1125   0.3625 0.0625
Grave    0.0000   0.0375 0.1750
Total    0.2250   0.5000 0.2750</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_extended</span> <span class="op">&lt;-</span> <span class="va">df_extended</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">df_extended</span><span class="op">)</span><span class="op">)</span> <span class="co"># arreglar lo de las librerías</span></span>
<span><span class="va">df_extended</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Leve Moderada  Grave  Total
Leve     0.1125   0.1000 0.0375 0.2500
Moderada 0.1125   0.3625 0.0625 0.5375
Grave    0.0000   0.0375 0.1750 0.2125
Total    0.2250   0.5000 0.2750 1.0000</code></pre>
</div>
</div>
<section id="medida-de-concordancia-global" class="level3"><h3 class="anchored" data-anchor-id="medida-de-concordancia-global">Medida de concordancia global</h3>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65</code></pre>
</div>
</div>
</section><section id="medida-de-concordancia-debida-al-azar" class="level3"><h3 class="anchored" data-anchor-id="medida-de-concordancia-debida-al-azar">Medida de concordancia debida al azar</h3>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df_extended</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">+</span> <span class="va">df_extended</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="va">df_extended</span><span class="op">[</span><span class="va">t</span>,<span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3834375</code></pre>
</div>
</div>
</section><section id="índice-kappa" class="level3"><h3 class="anchored" data-anchor-id="índice-kappa">Índice kappa</h3>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4323365</code></pre>
</div>
</div>
<p>El índice kappa no mide la distancia entre las discordancias. No es lo mismo decir (X=7, Y=8) que (X=7, Y=2).</p>
</section><section id="comparando-cada-categoría-con-el-resto" class="level3"><h3 class="anchored" data-anchor-id="comparando-cada-categoría-con-el-resto">Comparando cada categoría con el resto</h3>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Leve Moderada  Grave
Leve     0.1125   0.1000 0.0375
Moderada 0.1125   0.3625 0.0625
Grave    0.0000   0.0375 0.1750</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cat</span> <span class="op">&lt;-</span> <span class="st">"Leve"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Categoría de referencia:"</span>, <span class="va">cat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_new</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"Otras"</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">cat</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">cat</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_new</span><span class="op">[</span><span class="st">"Otras"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_new</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df_new</span> <span class="op">&lt;-</span> <span class="va">df_new</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cat</span>,<span class="st">"Otras"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_new</span>, <span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_new_extended</span> <span class="op">&lt;-</span> <span class="va">df_extended</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">df_extended</span><span class="op">)</span><span class="op">)</span> <span class="co"># arreglar lo de las librerías</span></span>
<span><span class="op">(</span><span class="va">df_new_extended</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Medida de concordancia global:"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Medida de concordancia debida al azar:"</span><span class="op">)</span></span>
<span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df_new_extended</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">+</span> <span class="va">df_new_extended</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="va">df_new_extended</span><span class="op">[</span><span class="va">t</span>,<span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Índice kappa:"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Categoría de referencia: Leve"
        Leve  Otras Total
Leve  0.1125 0.1375  0.25
Otras 0.1125 0.6375  0.75
Total 0.2250 0.7750  1.00
[1] "Medida de concordancia global:"
[1] 0.75
[1] "Medida de concordancia debida al azar:"
[1] 0.6375
[1] "Índice kappa:"
[1] 0.3103448</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cat</span> <span class="op">&lt;-</span> <span class="st">"Moderada"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Categoría de referencia:"</span>, <span class="va">cat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_new</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"Otras"</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">cat</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">cat</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_new</span><span class="op">[</span><span class="st">"Otras"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_new</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df_new</span> <span class="op">&lt;-</span> <span class="va">df_new</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cat</span>,<span class="st">"Otras"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_new</span>, <span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_new_extended</span> <span class="op">&lt;-</span> <span class="va">df_extended</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">df_extended</span><span class="op">)</span><span class="op">)</span> <span class="co"># arreglar lo de las librerías</span></span>
<span><span class="op">(</span><span class="va">df_new_extended</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Medida de concordancia global:"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Medida de concordancia debida al azar:"</span><span class="op">)</span></span>
<span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df_new_extended</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">+</span> <span class="va">df_new_extended</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="va">df_new_extended</span><span class="op">[</span><span class="va">t</span>,<span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Índice kappa:"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Categoría de referencia: Moderada"
         Moderada Otras  Total
Moderada   0.3625 0.175 0.5375
Otras      0.1375 0.325 0.4625
Total      0.5000 0.500 1.0000
[1] "Medida de concordancia global:"
[1] 0.6875
[1] "Medida de concordancia debida al azar:"
[1] 0.5
[1] "Índice kappa:"
[1] 0.375</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cat</span> <span class="op">&lt;-</span> <span class="st">"Grave"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Categoría de referencia:"</span>, <span class="va">cat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_new</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"Otras"</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">cat</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">cat</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_new</span><span class="op">[</span><span class="st">"Otras"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_new</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df_new</span> <span class="op">&lt;-</span> <span class="va">df_new</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cat</span>,<span class="st">"Otras"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_new</span>, <span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_new_extended</span> <span class="op">&lt;-</span> <span class="va">df_extended</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span><span class="st">"Total"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">df_extended</span><span class="op">)</span><span class="op">)</span> <span class="co"># arreglar lo de las librerías</span></span>
<span><span class="op">(</span><span class="va">df_new_extended</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Medida de concordancia global:"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df_new</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Medida de concordancia debida al azar:"</span><span class="op">)</span></span>
<span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df_new_extended</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">+</span> <span class="va">df_new_extended</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">*</span><span class="va">df_new_extended</span><span class="op">[</span><span class="va">t</span>,<span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="va">pi_1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Índice kappa:"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Categoría de referencia: Grave"
      Grave  Otras  Total
Grave 0.175 0.0375 0.2125
Otras 0.100 0.6875 0.7875
Total 0.275 0.7250 1.0000
[1] "Medida de concordancia global:"
[1] 0.8625
[1] "Medida de concordancia debida al azar:"
[1] 0.629375
[1] "Índice kappa:"
[1] 0.6290051</code></pre>
</div>
</div>
<p>Hasta ahora hemos hablado de probabilidades ya que estamos con el modelo teórico. Cuando trabajamoes con datos de una muestra hablaremos de porcentajes. <span class="math inline">\(\Rightarrow\)</span> <em>“Este % es consecuencia de un acuerdo de tal y un azar de no sé cuántos”</em></p>
<p>El índice kappa tiene una distribución teórica y lo estimo según una muestra. Con una poca información (la muestra) doy un intervalo. No doy intervalos de confianza para valores desconocidos sino para las estimaciones.</p>
</section></section><section id="inconvenientes-del-índice-kappa" class="level2"><h2 class="anchored" data-anchor-id="inconvenientes-del-índice-kappa">Inconvenientes del índice kappa</h2>
<p><u><strong>Ejemplo 1.1.</strong></u></p>
<p><span class="math display">\[
\begin{array}{cc|ccc}
&amp; &amp; \textbf{Radiólogo A} \\
&amp; &amp; \textbf{Pulmonía} &amp; \textbf{No pulmonía} &amp; \textbf{Total} \\
\hline
\textbf{Radiólogo B} &amp; \textbf{Pulmonía} &amp; 0.04 &amp; 0.06 &amp; 0.10 \\
                      &amp; \textbf{No pulmonía} &amp; 0.10 &amp; 0.80 &amp; 0.90 \\
\hline
&amp; \textbf{Total} &amp; 0.14 &amp; 0.86 &amp; 1 \\
\end{array}
\]</span></p>
<p>La prevalencia de pulmonía es baja: <strong>014 para el radiólogo A y 0.1 para el rediólogo B</strong>.</p>
<p>**Ambas marginales desequilibradas*: la prevalencia observada dista mucho de 0.5 (a favor de los diagnósticos negativos)</p>
<p>El bajo valor del índice kappa se explica porque nos encontramos en el peor de los escenarios: baja prevalencia y marginales desequilibradas.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.84</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía B"</span>,<span class="op">]</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía B"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.788</span></span>
<span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.245283</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="el-valor-del-índice-kappa-depende-de-la-prevalencia-de-la-característica-observada." class="level3"><h3 class="anchored" data-anchor-id="el-valor-del-índice-kappa-depende-de-la-prevalencia-de-la-característica-observada.">El valor del índice kappa depende de la prevalencia de la característica observada.</h3>
<p><u><strong>Ejemplo 1.1.a.</strong></u></p>
<p><span class="math display">\[
\begin{array}{cc|ccc}
&amp; &amp; \textbf{Radiólogo A} \\
&amp; &amp; \textbf{Pulmonía} &amp; \textbf{No pulmonía} &amp; \textbf{Total} \\
\hline
\textbf{Radiólogo B} &amp; \textbf{Pulmonía} &amp; 0.30 &amp; 0.06 &amp; 0.36 \\
                      &amp; \textbf{No pulmonía} &amp; 0.10 &amp; 0.54 &amp; 0.64 \\
\hline
&amp; \textbf{Total} &amp; 0.40 &amp; 0.60 &amp; 1 \\
\end{array}
\]</span></p>
<p>Aumentamos la prevalencia: <strong>0.40 para el radiólogo A y 0.36 para el rediólogo B</strong>.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.84</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía B"</span>,<span class="op">]</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía B"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.528</span></span>
<span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.6610169</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="recuadro_2">
<p><strong>Cuanto más cercana a 0,5 sea la prevalencia (más equilibradas estén las marginales) mayor es el índice kappa, para igual probabilidad de acuerdos observados.</strong></p>
</div>
<p><span class="math display">\[\Downarrow\]</span></p>
<div class="recuadro_2">
<p><strong>Prevalencias muy altas o muy bajas penalizan el índice kappa.</strong></p>
</div>
</section><section id="el-valor-del-índice-kappa-depende-de-la-simetría-y-homogeneidad-de-las-marginales." class="level3"><h3 class="anchored" data-anchor-id="el-valor-del-índice-kappa-depende-de-la-simetría-y-homogeneidad-de-las-marginales.">El valor del índice kappa depende de la simetría y homogeneidad de las marginales.</h3>
<p>En el primer caso el comportamiento de los agentes es homogéneo: pues ambos emiten informes positivos con mayor frecuencia.</p>
<p>En el segundo caso el comportamiento de los agentes es heterogéneo y asimétrico.</p>
<p>En ambos casos los diagnósticos del agente A distan 0.2 de 0.5.</p>
<p><span class="math display">\[
\begin{array}{cc|ccc}
&amp; &amp; \textbf{Radiólogo A} \\
&amp; &amp; \textbf{Pulmonía} &amp; \textbf{No pulmonía} &amp; \textbf{Total} \\
\hline
\textbf{Radiólogo B} &amp; \textbf{Pulmonía} &amp; 0.45 &amp; 0.15 &amp; 0.60 \\
                      &amp; \textbf{No pulmonía} &amp; 0.25 &amp; 0.15 &amp; 0.40 \\
\hline
&amp; \textbf{Total} &amp; 0.70 &amp; 0.30 &amp; 1 \\
&amp;  &amp; 0.50+0.20 &amp; 0.50-0.20 &amp;  \\
\end{array}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.84</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía B"</span>,<span class="op">]</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía B"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.54</span></span>
<span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.6521739</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[
\begin{array}{cc|ccc}
&amp; &amp; \textbf{Radiólogo A} \\
&amp; &amp; \textbf{Pulmonía} &amp; \textbf{No pulmonía} &amp; \textbf{Total} \\
\hline
\textbf{Radiólogo B} &amp; \textbf{Pulmonía} &amp; 0.25 &amp; 0.35 &amp; 0.60 \\
                      &amp; \textbf{No pulmonía} &amp; 0.05 &amp; 0.35 &amp; 0.40 \\
\hline
&amp; \textbf{Total} &amp; 0.30 &amp; 0.70 &amp; 1 \\
&amp;  &amp; 0.50-0.20 &amp; 0.50+0.20 &amp;  \\
\end{array}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.84</span></span>
<span><span class="op">(</span><span class="va">pi_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"Pulmonía B"</span>,<span class="op">]</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía A"</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="st">"No pulmonía B"</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.46</span></span>
<span><span class="op">(</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">pi_0</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi_1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.7037037</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="el-valor-del-índice-kappa-depende-del-equilibrio-de-las-marginales." class="level3"><h3 class="anchored" data-anchor-id="el-valor-del-índice-kappa-depende-del-equilibrio-de-las-marginales.">El valor del índice kappa depende del equilibrio de las marginales.</h3>
<p>Cuanto mayor sea la diferencia de la prevalencia observada de cada agente respecto de 0.5 mayor es el índice kappa. (incluso para un mismo valor de acuerdos observados).</p>
</section></section><section id="índice-kappa-ponderado." class="level2"><h2 class="anchored" data-anchor-id="índice-kappa-ponderado.">Índice kappa ponderado.</h2>
<p><strong>Sólo tiene sentido para variables ordinales.</strong></p>
<p>Está diseñado para recoger la idea de que algunas discordancias son más severas que otras y, por tanto, asigna pesos que representan la importancia entre los desacuerdos. El máximo peso se da a la concordancia perfecta y pesos proporcionalmente menores según la importancia del desacuerdo.</p>
<p>No tiene la misma importancia un desacuerdo en la clasificación entre las categorías leve y moderada que entre leve y grave, obviamente la última representa un mayor desacuerdo que la primera.</p>
<div class="recuadro_2">
<p><strong>Medida de concordancia global</strong>: <span class="math inline">\(\Pi_0 = \sum_{i=1}^{t} \sum_{j=1}^{t} w_{ij} \pi_{ij}\)</span></p>
</div>
<div class="recuadro_2">
<p><strong>Medida de concordancia debida al azar</strong>: <span class="math inline">\(\Pi_c = \sum_{i=1}^{t} \sum_{j=1}^{t} w_{ij} \pi_{i.}\pi_{.j}\)</span></p>
</div>
<div class="recuadro_2">
<p><strong>Índice kappa</strong>: <span class="math inline">\(k_{w} = \frac{\Pi_0-\Pi_c}{1-\Pi_c}\)</span></p>
</div>
<p>Los pesos satisfacen:</p>
<p><span class="math display">\[
w_{ij} = \begin{cases}
w_{ii} = 1 \\
0 \le w_{ij} \le 1 \\
w_{ij} = w_{ji}
\end{cases}
\]</span></p>
<p><span class="math display">\[
w_{ij} = \begin{cases}
1, \hspace{1em} i = j \\
0, \hspace{1em} i \neq j \\
\end{cases} \hspace{1em} \text{sii} \hspace{1em} k_{w} = k \\
\]</span> <span class="math display">\[
\text{si t = 2} \Rightarrow k_{w} = k
\]</span></p>
<section id="ponderaciones." class="level3"><h3 class="anchored" data-anchor-id="ponderaciones.">Ponderaciones.</h3>
<ul>
<li><p><strong>Cicchetti-Allison (1971)</strong> <span class="math inline">\(w_{ij} = 1 - \frac{|i-j|}{t-1}\)</span></p></li>
<li><p><strong>Fleiss-Cohen (1973)</strong> <span class="math inline">\(w_{ij} = 1 - \frac{(i-j)^2}{(t-1)^2}\)</span></p></li>
</ul></section></section><section id="tratamiento-muestral-de-los-índices-kappa" class="level2"><h2 class="anchored" data-anchor-id="tratamiento-muestral-de-los-índices-kappa">Tratamiento muestral de los índices kappa</h2>
<p>Sea:</p>
<ul>
<li>n el número de individuos en la muestra.</li>
<li>
<span class="math inline">\(p_ij\)</span> <strong>la proporción</strong> de individuos asignados a la categoría i por el observador X y a la categoría j por el observador Y, donde i, j =1,2,…,t.</li>
<li>
<span class="math inline">\(p_{i.}\)</span> <strong>la proporción</strong> marginal de que un sujeto sea asignado a la clase i por el observador X (análogo para <span class="math inline">\(p_{.j}\)</span>, la clase j y el observador Y), donde i, j =1,2,…,t.
<ul>
<li>
<span class="math inline">\(p_{i.}\)</span> = <span class="math inline">\(p_{i1}\)</span> + … + <span class="math inline">\(p_{it}\)</span>
</li>
<li>
<span class="math inline">\(p_{.j}\)</span> = <span class="math inline">\(p_{1j}\)</span> + … + <span class="math inline">\(p_{tj}\)</span>
</li>
</ul>
</li>
</ul>
<p>Tenemos:</p>
<p><span class="math display">\[E(p_{ij}) = \pi_{ij}, \quad E(p_{i.}) = \pi_{i.}, \quad E(p_{.j}) = \pi_{.j}\]</span></p>
<p><u>El estimador del índice de kappa ponderado es:</u></p>
<p><span class="math display">\[
\kappa_w = \frac{P_0 - P_c}{1 - P_c}, \quad P_0 = \sum_{i=1}^{t}\sum_{j=1}^{t} w_{ij}p_{ij}, \quad P_c = \sum_{i=1}^{t}\sum_{j=1}^{t} w_{ij}p_{i.}p_{.j}
\]</span></p>
<p>Es un estimador con una distribución asintótica normal.</p>
<p><span class="math display">\[ \kappa_w ~ N(\kappa_w, \sigma_{\kappa_w})\]</span></p>
<p>Tengo una distribucion normal centrada en k y al elegir un dato al azar (o sea, de la muestra aleatoria) puede tener un valor muy cercano o muy lejano de la media.</p>
<p>La varianza también es una estimación hecha con lo que yo he visto. Es otra estimación más. Esto hace que vayamos arrastrando aproximaciones AKA posibles errores.</p>
<p><span class="math display">\[
\displaylines{
\sigma^2_{\kappa_w} = \frac{\sum_i \sum_j \pi_{ij} \left[ w_{ij} - (\overline{w}_{i \cdot} + \overline{w}_{\cdot j})(1 - \kappa_w) \right]^2 - \left[ \kappa_w - \Pi_c (1 - \kappa_w) \right]^2}{n (1 - \Pi_c)^2} \\
\overline{w}_{i \cdot} = \sum_{j=1}^t \pi_{\cdot j} w_{ij} \\
\overline{w}_{\cdot j} = \sum_{i=1}^t \pi_{i \cdot} w_{ij}
}
\]</span></p>
<p>El estimador de esta varianza su contrapartida muestral, sustituyendo <strong>probabilidades por proporciones</strong> y el índice kappa por su estimador.</p>
<p><span class="math display">\[
\displaylines{
\hat{\sigma}^2_{\kappa_w} = s^2_{\kappa_w} = \frac{\sum_i \sum_j p_{ij} \left[ w_{ij} - (\hat{w}_{i \cdot} + \hat{w}_{\cdot j})(1 - \hat{\kappa}_w) \right]^2 - \left[ \hat{\kappa}_w - P_c (1 - \hat{\kappa}_w) \right]^2}{n (1 - P_c)^2} \\
\hat{w}_{i \cdot} = \sum_{j=1}^t p_{\cdot j} w_{ij} \\
\hat{w}_{\cdot j} = \sum_{i=1}^t p_{i \cdot} w_{ij}
}
\]</span> Límites de confianza para el índice kappa con nivel de confianza <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[ \hat{\kappa}_w +- z_\alpha s_{\hat{\kappa}_w}\]</span></p>
<p><u><strong>Escala de valoración del índice Kappa.</strong></u></p>
<p><span class="math display">\[
\begin{array}{c|c}
\textbf{Kappa} &amp; \textbf{Grado de concordancia} \\
\hline
&lt; 0.00 &amp; \text{Sin concordancia} \\
0.00 - 0.20  &amp; \text{Insignificante} \\
0.20 - 0.40  &amp; \text{Discreta} \\
0.40 - 0.60  &amp; \text{Moderada} \\
0.60 - 0.80  &amp; \text{Sustancial} \\
0.80 - 1  &amp; \text{Casi perfecta} \\
\end{array}
\]</span></p>
<p><u><strong>Ejemplo 1.3.</strong></u></p>
<p>Dos radiólogos independientes informan de la presencia o ausencia de neumonía en 100 radiografías, siendo los resultados los siguientes.</p>
<p><span class="math display">\[
\begin{array}{cc|ccc}
&amp; &amp; \textbf{Radiólogo A} \\
&amp; &amp; \textbf{Neumonía} &amp; \textbf{No neumonía} &amp; \textbf{Total} \\
\hline
\textbf{Radiólogo B} &amp; \textbf{Neumonía} &amp; 4 &amp; 6 &amp; 10 \\
                      &amp; \textbf{No neumonía} &amp; 10 &amp; 80 &amp; 90 \\
\hline
&amp; \textbf{Total} &amp; 14 &amp; 86 &amp; 100 \\
\end{array}
\]</span></p>
<p><span class="math inline">\(P_0 = \frac{4+80}{100} = 0.84 \quad \quad P_c = \frac{10*14 + 90*86}{100^2} = 0.788\)</span><br><span class="math inline">\(\hat{\kappa_w} = \frac{0.84 - 0.788}{1 - 0.788} = 0.245\)</span><br><span class="math inline">\(s^2_{\kappa_w} = 0.018 \quad \quad z_{0.05}s_{\kappa_w} = 1.65 \sqrt{0.018} = 0.22\)</span></p>
<p>Se podría hacer también un aproximación asintótica pero conlleva arrastrar una simulacion más.</p>
<p>La estimación puntual la tengo. Como no tengo una muestra más grande puedo remuestrear.</p>
<p>Los estimadores por intervalo miden la precision de la estimación puntual. Cómo de buena es esa estimación puntual para representar otra posible muestra que podríamos haber obtenido.</p>
<p>Una estimación puntual que se encuentra en alguno de los intervalos de Landis y Koch.</p>
<p><strong>La validez de la estimacion hay que refrentarla con un IC.</strong> La estimación puntual de 0.245 se considera discreta y el <span class="math inline">\(IC_90 = (0.025, 0.465)\)</span> abarca varios niveles, desde discreta hasta sustancial. Si el IC estuviera solo en el mismo intervalo que la estimación puntual diríamos que el IC respalda/valida la estimacion puntual. Al abarcar más de un nivel deberemos explicarlo.</p>
<p><strong>En el 90 % de estudios similares a este tenemos una concordancia que iría desde insignificante a moderada. La validaz de nuestra estimación no es super cool, es cuestionable, ya que hay otros estudios donde podemos encontrar una concordancia diferente a la que hemos calculado en esta muestra.</strong></p>
<p>H0: las opiniones son independientes (que no hay relación entre las opiniones) (si hay una concordancia que sea casual) AKA <span class="math inline">\(\rho\)</span> = 0.</p>
<p>Para poder admitir <span class="math inline">\(\rho\)</span> = 0 el IC tendría que darlo como un valor posible y en este caso no lo da. Rechazamos que haya un criterio diferente. (juzgamos que los dos puntúen por igual)</p>
<section id="ejemplo-1.4." class="level3"><h3 class="anchored" data-anchor-id="ejemplo-1.4.">Ejemplo 1.4.</h3>
<p>Dos psiquiatras evaluaron a 129 pacientes que habían sido diagnosticados previamente como clínicamente deprimidos. Las categorías de clasificación fueron: 0 para no deprimido, 1 para moderadamente deprimido y 2 para clínicamente deprimido. La tabla siguiente muestra los resultados de la clasificación realizada por los dos psiquiatras.</p>
<p><span class="math display">\[
\begin{array}{cc|ccc}
&amp; &amp; \textbf{Psiquiatra 1} \\
&amp; &amp; \textbf{0} &amp; \textbf{1} &amp; \textbf{2} &amp; \textbf{Total} \\
\hline
\textbf{Psiquiatra 2} &amp; \textbf{0} &amp; 11 &amp; 2 &amp; 19 &amp; 32 \\
                      &amp; \textbf{1} &amp; 1 &amp; 3 &amp; 3 &amp; 7 \\
                      &amp; \textbf{2} &amp; 0 &amp; 8 &amp; 82 &amp; 90 \\
\hline
&amp; \textbf{Total} &amp; 12 &amp; 13 &amp; 104 &amp; 129 \\
\end{array}
\]</span></p>
<p><u><strong>Datos.</strong></u></p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">2</span>,<span class="fl">19</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">8</span>,<span class="fl">82</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   11    2   19
[2,]    1    3    3
[3,]    0    8   82</code></pre>
</div>
</div>
<p><u><strong>Índice kappa en R por defecto.</strong></u></p>
<p>En la diagonal pone peso 0 (yo quiero que en la diagonal tiene 1 y conforme me alejo lo voy bajando).</p>
<p><u><strong>Índice kappa sin ponderar.</strong></u></p>
<p>Le damos importancia a todo lo que coincide pero no le damos peso a la cercanía entre dos diagnósticos. La elección por el kappa ponderado es crucial cuando los niveles de clasificación son mayores a dos niveles.</p>
<p><u><strong>Pesos Ciccetti y Allison.</strong></u></p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">w_CA</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0</span>, <span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]  1.0  0.5  0.0
[2,]  0.5  1.0  0.5
[3,]  0.0  0.5  1.0</code></pre>
</div>
</div>
<p><u><strong>Estimaciones de kappa.</strong></u></p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kappa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/kappa.html">cohen.kappa</a></span><span class="op">(</span><span class="va">A</span>, w<span class="op">=</span><span class="va">w_CA</span>, n.obs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">kappa1</span><span class="op">)</span></span>
<span><span class="co">## List of 11</span></span>
<span><span class="co">##  $ kappa         : num 0.375</span></span>
<span><span class="co">##  $ weighted.kappa: num 0.402</span></span>
<span><span class="co">##  $ n.obs         : num 129</span></span>
<span><span class="co">##  $ agree         : num [1:3, 1:3] 0.08527 0.00775 0 0.0155 0.02326 ...</span></span>
<span><span class="co">##  $ weight        : num [1:3, 1:3] 1 0.5 0 0.5 1 0.5 0 0.5 1</span></span>
<span><span class="co">##  $ var.kappa     : num 0.00622</span></span>
<span><span class="co">##  $ var.weighted  : num 0.00688</span></span>
<span><span class="co">##  $ confid        : num [1:2, 1:3] 0.245 0.265 0.375 0.402 0.504 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:2] "unweighted kappa" "weighted kappa"</span></span>
<span><span class="co">##   .. ..$ : chr [1:3] "lower" "estimate" "upper"</span></span>
<span><span class="co">##  $ plevel        : num 0.1</span></span>
<span><span class="co">##  $ bad           : logi FALSE</span></span>
<span><span class="co">##  $ Call          : language cohen.kappa1(x = x, w = w, n.obs = n.obs, alpha = alpha, levels = levels,      w.exp = w.exp)</span></span>
<span><span class="co">##  - attr(*, "class")= chr [1:2] "psych" "kappa"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kappa1</span><span class="op">$</span><span class="va">kappa</span></span>
<span><span class="co">## [1] 0.3745225</span></span>
<span><span class="va">kappa1</span><span class="op">$</span><span class="va">weighted.kappa</span></span>
<span><span class="co">## [1] 0.4018192</span></span>
<span><span class="va">kappa1</span><span class="op">$</span><span class="va">var.kappa</span></span>
<span><span class="co">## [1] 0.006221038</span></span>
<span><span class="va">kappa1</span><span class="op">$</span><span class="va">var.weighted</span></span>
<span><span class="co">## [1] 0.006884677</span></span>
<span><span class="va">kappa1</span><span class="op">$</span><span class="va">confid</span></span>
<span><span class="co">##                      lower  estimate     upper</span></span>
<span><span class="co">## unweighted kappa 0.2447870 0.3745225 0.5042579</span></span>
<span><span class="co">## weighted kappa   0.2653391 0.4018192 0.5382992</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u><strong>Pesos de Fleiss y Cohen.</strong></u></p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">w_FC</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">1</span>,<span class="fl">0.75</span>,<span class="fl">0</span>,<span class="fl">0.75</span>,<span class="fl">1</span>,<span class="fl">0.75</span>,<span class="fl">0</span>,<span class="fl">0.75</span>,<span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,] 1.00 0.75 0.00
[2,] 0.75 1.00 0.75
[3,] 0.00 0.75 1.00</code></pre>
</div>
</div>
<p><u><strong>Estimaciones de kappa.</strong></u></p>
<div class="cell">
<details><summary>Código</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kappa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/kappa.html">cohen.kappa</a></span><span class="op">(</span><span class="va">A</span>, w<span class="op">=</span><span class="va">w_FC</span>, n.obs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>,alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">kappa2</span><span class="op">)</span></span>
<span><span class="co">## List of 11</span></span>
<span><span class="co">##  $ kappa         : num 0.375</span></span>
<span><span class="co">##  $ weighted.kappa: num 0.42</span></span>
<span><span class="co">##  $ n.obs         : num 129</span></span>
<span><span class="co">##  $ agree         : num [1:3, 1:3] 0.08527 0.00775 0 0.0155 0.02326 ...</span></span>
<span><span class="co">##  $ weight        : num [1:3, 1:3] 1 0.75 0 0.75 1 0.75 0 0.75 1</span></span>
<span><span class="co">##  $ var.kappa     : num 0.00622</span></span>
<span><span class="co">##  $ var.weighted  : num 0.00796</span></span>
<span><span class="co">##  $ confid        : num [1:2, 1:3] 0.245 0.274 0.375 0.42 0.504 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:2] "unweighted kappa" "weighted kappa"</span></span>
<span><span class="co">##   .. ..$ : chr [1:3] "lower" "estimate" "upper"</span></span>
<span><span class="co">##  $ plevel        : num 0.1</span></span>
<span><span class="co">##  $ bad           : logi FALSE</span></span>
<span><span class="co">##  $ Call          : language cohen.kappa1(x = x, w = w, n.obs = n.obs, alpha = alpha, levels = levels,      w.exp = w.exp)</span></span>
<span><span class="co">##  - attr(*, "class")= chr [1:2] "psych" "kappa"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kappa2</span><span class="op">$</span><span class="va">weighted.kappa</span></span>
<span><span class="co">## [1] 0.4203694</span></span>
<span><span class="va">kappa2</span><span class="op">$</span><span class="va">var.weighted</span></span>
<span><span class="co">## [1] 0.007955659</span></span>
<span><span class="va">kappa2</span><span class="op">$</span><span class="va">confid</span></span>
<span><span class="co">##                      lower  estimate     upper</span></span>
<span><span class="co">## unweighted kappa 0.2447870 0.3745225 0.5042579</span></span>
<span><span class="co">## weighted kappa   0.2736575 0.4203694 0.5670813</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[
\begin{array}{c|c}
\textbf{Estadístico} &amp; \textbf{Estimación} &amp; \textbf{Varianza estimada} &amp; LI_{90} \\
\hline
\text{Kappa sin ponderar} &amp; 0.3745225 &amp; 0.006221038 &amp; 0.2447870 \\
\text{Kappa ponderado (Ciccetti-Allison)} &amp; 0.4018192 &amp; 0.006884677 &amp; 0.2653391 \\
\text{Kappa ponderado (Fleiss-Cohen)} &amp; 04203694 &amp; 0007955659 &amp; 0.2736575 \\
\end{array}
\]</span></p>
<p>Estamos teniendo resultados 0.3, 0.4. Las estimaciones puntuales nos incitan a <strong>concordancias moderadas. No podemos decir que no tengan un criterio común. algo tienen.</strong></p>
<p>¿Qué pasha cuando tenemos que analizar la validez de una estimación pero tenemos una muestra pequeña? Po a la metodología booststrap</p>
<p><a href="../tema_03/tema_03_3_obtener_datos_simulados.html#Ejemplo: Validar índice Kappa"><em>Nos vamos a Tema 3, página 55.</em></a></p>
<p>Depués de remuestrar tengo las 23 radiografías con la clasificación de los dos radiólogos cuando remuestre.</p>
<p>Obtengo muestras bootstrap con 23 radiografias pero la clasificación es la misma para cada radiografía.</p>
<p>Calculo el kappa <span class="math inline">\(\Rightarrow\)</span> calculo las diferencias <span class="math inline">\(\Rightarrow\)</span> Despercio las más alejadas <span class="math inline">\(\Rightarrow\)</span> Me quedo con el 95 % central.</p>
<p><strong>Si hay más de 2 observadores <span class="math inline">\(\Rightarrow\)</span> Índice de Kappa para múltiples observadores (Fleiss JL Statistical Methods for Rates and Proportions, 2003)</strong></p>


</section></section><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../tema_01/tema_01_1_introduccion.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">1. Introducción <span style="color:green;">✓</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../tema_01/tema_01_3_concordancia_numericas.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">3. Análisis de concordancia en variables numéricas <span style="color:red;">✗</span></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->

</div></section></main>
</div>


</body></html>